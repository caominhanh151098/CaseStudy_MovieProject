<html xmlns:th="http://www.thymeleaf.org" lang="en">
<div th:fragment="js">
    <script th:inline="javascript">
        let showDetail = document.getElementById("movie_detail");
        let url = location.href;
        let id = url.slice(27);
        let idSeries = id;
        let movie;
        initData();

        function displayStatus(text) {
            if (text == "COMPLETE")
                return  "Hoàn thành";
            else if (trues == "SHOWING")
                return  "Đang chiếu";
            else return  "Sắp khởi chiếu";
        }

        function initData() {
            $.ajax({
                url: `http://localhost:8080/api/movie/${id}`,
                method: "GET"
            }).done(data => {
                movie = data;
                movie.status = displayStatus(data.status);
                movie.quality = displayQuality(data.quality)
                let imgUrl = "&quot;" + movie.img_poster + "&quot;";
                showDetail.innerHTML = `
            <div class="row">
                <div class="col-lg-3">
                    <div class="anime__details__pic set-bg" data-setbg="${movie.img_poster}"
                         style="background-image: url(${imgUrl});">
                        <div class="comment"><i class="fa fa-comments"></i> ${movie.commentNum}</div>
                        <div class="view"><i class="fa fa-eye"></i> 9141</div>
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="anime__details__text">
                        <div class="anime__details__title">
                            <h3>${movie.name}</h3>
                            <span></span>
                        </div>
                        <div class="anime__details__rating">
                            <div class="rating">
                                <a href="#"><i class="fa fa-star"></i></a>
                                <a href="#"><i class="fa fa-star"></i></a>
                                <a href="#"><i class="fa fa-star"></i></a>
                                <a href="#"><i class="fa fa-star"></i></a>
                                <a href="#"><i class="fa fa-star-half-o"></i></a>
                            </div>
                            <span>1.029 Votes</span>
                        </div>
                        <p>${movie.description}</p>
                        <div class="anime__details__widget">
                            <div class="row">
                                <div class="col-lg-6 col-md-6">
                                    <ul>
                                        <li><span>Năm phát hành:</span>${movie.airedYear}</li>
                                        <li><span>Thể loại:</span>${movie.movieGenres}</li>
                                        <li><span>Chất lượng:</span>${movie.quality}</li>
                                        <li><span>Tình trạng:</span>${movie.status}</li>
                                    </ul>
                                </div>
                                <div class="col-lg-6 col-md-6">
                                    <ul>
                                        <li><span>Điểm:</span>${movie.scoreIMDb + ' / 10.0 IMDb'}</li>
                                        <li><span>Thời lượng:</span>${movie.duration}</li>
                                        <li><span>Đạo diễn:</span>${movie.directors}</li>
                                        <li><span>Diễn viên:</span>${movie.actors}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="anime__details__btn">
                            <a href="#" class="follow-btn"><i class="fa fa-heart-o"></i> Follow</a>
                            <a class="watch-btn" onclick="watchFilm()"><span>Watch Now</span> <i
                                    class="fa fa-angle-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>`
            })
        }

        function watchFilm() {
            location.href = `/xem-phim/${id}`;
        }

        function displayQuality(text) {
            if (text == "HD_VIET_SUB")
                return "HD Vietsub"
            else return text;
        }
    </script>
</div>